1
00:00:00,000 --> 00:00:09,080
네 안녕하세요 쿠버네티스의 개들을풀어라 라는 주제로

2
00:00:09,080 --> 00:00:12,160
라이트닝토크 발표하게 되어 홍석주 라고 합니다

3
00:00:12,160 --> 00:00:13,780
저는 그 펍지주식회사 에서

4
00:00:13,780 --> 00:00:15,570
대법사 엔지니어로 일을 하고 있고요

5
00:00:15,570 --> 00:00:17,670
최근에 이제 쿠버네티스로 서버서비스

6
00:00:17,670 --> 00:00:20,930
이전하는 작업을 열심히 하고 갖고 놀고 있어요

7
00:00:20,930 --> 00:00:25,230
여기서 그 개들을풀어라 에게 데이터도 거를 데이터도

8
00:00:25,230 --> 00:00:27,070
그러면 클라우드 서비스를 말을 해

9
00:00:27,070 --> 00:00:30,460
서비스 같은 경우는 이제 모니터링 전문 그 서비스인데

10
00:00:30,460 --> 00:00:33,100
알아서 그 필요한 지표들을 수지 버려져

11
00:00:33,100 --> 00:00:34,690
예를 들어 cpu 사용량 이라든가

12
00:00:34,690 --> 00:00:38,310
메모리 사용량 일반시스템 지표들도 수집을 해 주고

13
00:00:38,310 --> 00:00:41,130
그리고 지표에서 뭔가 이상이 있다 싶으니까

14
00:00:41,130 --> 00:00:42,190
장애가 있는 상황에서

15
00:00:42,190 --> 00:00:44,820
멍멍이가 그 투애니포세븐 으로 알려 주세요

16
00:00:44,820 --> 00:00:47,850
제가 새벽 네시 에 깨서 작업한 일도 있습니다

17
00:00:47,850 --> 00:00:52,690
네 그리고 쿠버네티스 요새 핫한 쿠버네티스 간략하게 설명드릴께요

18
00:00:52,690 --> 00:00:55,550
이제 컨테이너를 클러스터에 쉽고 빠르게 띄워 줘

19
00:00:55,550 --> 00:00:57,440
컨테이너가 주면 알아서 벚꽃도 잘해 주고

20
00:00:57,440 --> 00:01:00,390
이제 알아서 스케일링도 되게 잘 알려져 hpa

21
00:01:00,390 --> 00:01:03,750
나 시리 같은 기능을 이용해서 네

22
00:01:03,750 --> 00:01:07,120
그래서 이제 저희가 이제 서비스를 그 aws 해서

23
00:01:07,120 --> 00:01:09,130
이제 뜻으로 이전에 aws

24
00:01:09,130 --> 00:01:11,060
20초에서 쿠버네티스를 이전을 하면서

25
00:01:11,060 --> 00:01:13,450
이제 그 데이터 도구로 마찬가지로

26
00:01:13,450 --> 00:01:15,570
이제 그만해 키스를 모니터링을 하려고 해요

27
00:01:15,570 --> 00:01:16,550
있어 얘 같은 경우

28
00:01:16,550 --> 00:01:18,670
노변로 하나씩 그 똑같은 컨테이너 다 뜨는데

29
00:01:18,670 --> 00:01:20,490
몬세라 유형으로 배포를 해요

30
00:01:20,490 --> 00:01:22,800
그러면 이제 워커노드 이제 cpu 메모리

31
00:01:22,800 --> 00:01:24,570
나도 커맨드 쿠버네티스

32
00:01:24,570 --> 00:01:27,230
관련 매트릭스를 알아서 수집할 수 있게 해 줘요

33
00:01:27,230 --> 00:01:28,990
근데 우리는 이것만 중요한 게 아니에요

34
00:01:28,990 --> 00:01:31,030
그 마이크를 서비스를 엄청 많이 있는데

35
00:01:31,030 --> 00:01:35,530
그 예를 들어 그 여러 그 외부 인증 관련 장애 라든가

36
00:01:35,530 --> 00:01:37,790
이런 짓 수집을 해야 돼 해야 되기 때문에

37
00:01:37,790 --> 00:01:40,850
이제 그 저희가 커스텀 메트릭을 수집을 해야 돼요

38
00:01:40,850 --> 00:01:42,690
근데 이 시초라는 다르게

39
00:01:42,690 --> 00:01:43,780
이제 저희가 데이터 도구로

40
00:01:43,780 --> 00:01:46,780
직접 직접 쓸 수가 없는 문제가 발생했어요

41
00:01:46,780 --> 00:01:47,950
같은 노인의 데이터

42
00:01:47,950 --> 00:01:49,630
리필 알 수 있는 방법이 없었기 때문에

43
00:01:49,630 --> 00:01:52,880
그래서 이제 저희가 호스트포트 라는 비용을 코스코트

44
00:01:52,880 --> 00:01:53,760
난 기능을 이용 해서

45
00:01:53,760 --> 00:01:57,160
이제 그 마이크 서비스가 호스트 에다가 그 배터리 배송

46
00:01:57,160 --> 00:01:59,160
호스트 가이드 데이터도 알려 주는 식으로

47
00:01:59,160 --> 00:02:02,680
이제 커스텀 배터리가 수집을 하는 방식을 써요

48
00:02:02,680 --> 00:02:04,030
이게 그 문서에도 적혀있고

49
00:02:04,030 --> 00:02:05,710
왜 근데 만약 이

50
00:02:05,710 --> 00:02:07,730
저희 데이터 도구가 모종의 문제로 죽어요

51
00:02:07,730 --> 00:02:11,500
그러면 이제 저희 새로운 데이터도 그럴텐데

52
00:02:11,500 --> 00:02:14,420
메트릭이 그 사이에 데이터 들어가지 않고

53
00:02:14,420 --> 00:02:16,390
죽은 데이터도 그러게 속도는 문제가 돼서

54
00:02:16,390 --> 00:02:19,240
메트릭이 유실되는 문제가 발생하여 버려 그래 가지고

55
00:02:19,240 --> 00:02:22,460
이제 저희가 이제 그 죽은 데이터도 그에 관한 연결을 끊고

56
00:02:22,460 --> 00:02:24,710
3데이터 도구로 이제 연결을 이어져야 되는

57
00:02:24,710 --> 00:02:26,840
그런 문제가 생겼어요

58
00:02:26,840 --> 00:02:29,470
네 그래서 이제 이거를 어떻게 했는 야

59
00:02:29,470 --> 00:02:33,420
이거 이제 안 2주에서 3주 정도 고생을 해 가지고

60
00:02:33,420 --> 00:02:35,130
이제 그거 하는 애는 방법인데

61
00:02:35,130 --> 00:02:36,560
새 멍멍이가 뜨기 전에

62
00:02:36,560 --> 00:02:38,500
이제 죽은 연결을 날리는 커맨드를 쓰고

63
00:02:38,500 --> 00:02:39,670
이제 그 다음 에서

64
00:02:39,670 --> 00:02:42,750
스포트로 다시 지표를 수집하는 방식으로 당연하겠죠

65
00:02:42,750 --> 00:02:44,020
3번 그 뭐냐

66
00:02:44,020 --> 00:02:45,800
그 보통 이제 컨테이너 새로 뜨기 전에

67
00:02:45,800 --> 00:02:47,190
그 컨테이너를 미리 끼어 가지고

68
00:02:47,190 --> 00:02:49,500
필연적으로 먼저 하는 작업이 컨테이너라고 하는데

69
00:02:49,500 --> 00:02:52,710
거기에 이제 권한을 모두 문제 발생 말이야 그 뭐냐

70
00:02:52,710 --> 00:02:55,340
죽은 연결을 달리기 위해선 어드민권한 얘를

71
00:02:55,340 --> 00:02:56,710
이제 컨테이너에 못 들어가지고

72
00:02:56,710 --> 00:02:58,210
아 망했다 해 가지고

73
00:02:58,210 --> 00:03:01,290
네 그 이제 그 새로운 디플로이먼트 만들어서

74
00:03:01,290 --> 00:03:04,860
이제 디플로이먼트 한테 연결 좀 죽여 줄래 라고

75
00:03:04,860 --> 00:03:08,780
이제 요청하라고 죽은 연결을 날려버리는 식으로

76
00:03:08,780 --> 00:03:10,210
이제 구현을 했어요

77
00:03:10,210 --> 00:03:14,390
되게 그 자체는 되게 간단한 테스트인데

78
00:03:14,390 --> 00:03:15,870
그래서 이제 요구사항을 살펴보면

79
00:03:15,870 --> 00:03:18,890
그냥 ict 피코를 잘 받고 서브프로세스 잘생 시키고

80
00:03:18,890 --> 00:03:21,970
그리고 중요한 거 가장 심플 해야 되겠죠

81
00:03:21,970 --> 00:03:24,660
네 그래서 이제 그 제가 만들었는데요

82
00:03:24,660 --> 00:03:27,760
그 파이썬 기본 http 서버 모듈사용 해가지고

83
00:03:27,760 --> 00:03:29,110
별도의 모듈 같은 거

84
00:03:29,110 --> 00:03:32,470
디펜던시 매니지 관리 할 필요 없이 그냥 핸들러 하나만

85
00:03:32,470 --> 00:03:33,960
사 버리면 되는 문제로 바꿔서

86
00:03:33,960 --> 00:03:36,720
이제 풀어 이제 데이터가 잠깐 죽었다

87
00:03:36,720 --> 00:03:37,780
다시 또 잊어 행복하게

88
00:03:37,780 --> 00:03:40,050
모니터링을 할 수 있는 3번으로

89
00:03:40,050 --> 00:03:41,630
알람해 아주 불안하긴 한데

90
00:03:41,630 --> 00:03:45,890
행복한 모니터링 가능해졌다 스토리가 있습니다

91
00:03:45,890 --> 00:03:47,530
그래서 이제 그 코드를 핸들로 안에

92
00:03:47,530 --> 00:03:48,430
이렇게 코드를 떠나는데

93
00:03:48,430 --> 00:03:51,500
다녀도 일주일 만에 저희가 행복한 모니터링 가능해졌어요

94
00:03:51,500 --> 00:03:52,650
네 그래서 결론입니다

95
00:03:52,650 --> 00:03:56,160
제가 이 거리 설치하느라 구형 관련해서 일주일

96
00:03:56,160 --> 00:03:59,660
그리고 만약 그 문제 찾는 거는 3주 정도 걸렸고

97
00:03:59,660 --> 00:04:03,830
이제 그래서 결론적으로 호스트포트 기능을 이용할 때

98
00:04:03,830 --> 00:04:06,000
그 cni 플러그인 버그가 있으니까

99
00:04:06,000 --> 00:04:07,410
이거 혹시 데이터도 쓰시는 분들은

100
00:04:07,410 --> 00:04:10,610
꼭 참고를 해 주시면 좋을 것 같고요

101
00:04:10,610 --> 00:04:14,060
그리고 파이썬 서버 파일 서버 물론이고

102
00:04:14,060 --> 00:04:15,140
이제 그 이런

103
00:04:15,140 --> 00:04:16,370
이런 조그만 잡들이 되게

104
00:04:16,370 --> 00:04:17,490
쿠버네티스의 세상에서

105
00:04:17,490 --> 00:04:20,280
정말 중요한 고귀한 데 정말 파이썬

106
00:04:20,280 --> 00:04:21,400
그러면 정말 쉬워요 해가지고

107
00:04:21,400 --> 00:04:23,240
이런 일이 많아 문제도 너무 편하다

108
00:04:23,240 --> 00:04:26,070
나는 결론입니다 네 감사합니다
